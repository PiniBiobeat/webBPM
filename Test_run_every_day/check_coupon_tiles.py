import json

import requests



def check_get_coupon_tiles():

    url = "https://paymentsv4-api.lupa.co.il/api.aspx?method=check_coupon&coupon_code=T8233ZBA&is_collection_bucket=true&source_type=tiles&language=&source_device=desktop&token=075006004198174051194069114000059171223190201022241114097118246017106021141252132008248100179032200057179068154106101200050007232010073061230171&show_header=&newsletter=null"

    payload = {"master_id":0,"user_email":None,"order_id":14129252,"membership_level":0,"engines":["Tiles"],"partitions":[3],"items":[{"item_id":938190,"item_guid":"00000000-0000-0000-0000-000000000000","project_guid":"00000000-0000-0000-0000-000000000000","url":"https://tiles-api.lupa.co.il/img.aspx?token=075006004198174051194069114000059171223190201022241114097118246017106021141252132008248100179032200057179068154106101200050007232010073061230171&image=B44c1094f7e644a6b8ac414ed3e08dffd.jpg&projectguid=52722f90274949beb61e95c28aedff0f&type=no","itemImageUrl":"http://paymentsv4-api.lupa.co.il//img/black_frame.svg","parent_item_id":None,"product_type":7,"format":0,"material":2,"cover":None,"theme":None,"pages":None,"feature":None,"catalogue_code":"7_0_n_2_2_n_n_n","title":None,"price_group":0,"is_paspartu":False,"item_filter":"no","is_black_white":False,"frame_color":2,"quantity":2,"item_q1_price":0,"item_qx_price":0,"item_final_price":0,"item_total_price":0,"discounts":None}],"accessories":None,"delivery":None,"price_list":{"products":[{"catalogue_code":"7_0_n_1_n_n_n_n","price_group":1,"title":"20X20 בריבוע לופה","invoice_name":"20X20 בריבוע לופה","product_type":7,"category":1,"format":0,"material":1,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00001","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":42,"unit_price":42,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":36,"unit_price":32,"discounts":{"sale":4,"sale_remark":"מבצע סוף שנה 2023","membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_1_n_1_n_n_n_n","price_group":1,"title":"30X30 בריבוע לופה","invoice_name":"30X30 בריבוע לופה","product_type":7,"category":1,"format":1,"material":1,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00002","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":69,"unit_price":69,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":63,"unit_price":59,"discounts":{"sale":4,"sale_remark":"מבצע סוף שנה 2023","membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_1_n_2_1_n_n_n","price_group":1,"title":"לבנה מסגרת 30X30 בריבוע לופה","invoice_name":"לבנה מסגרת 30X30 בריבוע לופה","product_type":7,"category":1,"format":1,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00003","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":69,"unit_price":69,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":63,"unit_price":59,"discounts":{"sale":4,"sale_remark":"מבצע סוף שנה 2023","membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_0_n_2_1_n_n_n","price_group":1,"title":"לבנה מסגרת 20X20 בריבוע לופה","invoice_name":"לבנה מסגרת 20X20 בריבוע לופה","product_type":7,"category":1,"format":0,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00004","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":42,"unit_price":42,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":36,"unit_price":32,"discounts":{"sale":4,"sale_remark":"מבצע סוף שנה 2023","membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_0_n_2_2_n_n_n","price_group":1,"title":"שחורה מסגרת 20X20 בריבוע לופה","invoice_name":"שחורה מסגרת 20X20 בריבוע לופה","product_type":7,"category":1,"format":0,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00010","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":42,"unit_price":42,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":36,"unit_price":32,"discounts":{"sale":4,"sale_remark":"מבצע סוף שנה 2023","membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_1_n_2_2_n_n_n","price_group":1,"title":"שחורה מסגרת 30X30 בריבוע לופה","invoice_name":"שחורה מסגרת 30X30 בריבוע לופה","product_type":7,"category":1,"format":1,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00012","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":69,"unit_price":69,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":63,"unit_price":59,"discounts":{"sale":4,"sale_remark":"מבצע סוף שנה 2023","membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_322_n_2_2_2_2_n","price_group":5,"title":"בריבוע לופה פסיפס 2X2 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 2X2 מסגרת שחורה","product_type":7,"category":1,"format":322,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":144,"unit_price":144,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_323_n_2_2_2_3_n","price_group":5,"title":"בריבוע לופה פסיפס 2X3 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 2X3 מסגרת שחורה","product_type":7,"category":1,"format":323,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":216,"unit_price":216,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_332_n_2_2_3_2_n","price_group":5,"title":"בריבוע לופה פסיפס 3X2 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 3X2 מסגרת שחורה","product_type":7,"category":1,"format":332,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":216,"unit_price":216,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_333_n_2_2_3_3_n","price_group":5,"title":"בריבוע לופה פסיפס 3X3 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 3X3 מסגרת שחורה","product_type":7,"category":1,"format":333,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":324,"unit_price":324,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_334_n_2_2_3_4_n","price_group":5,"title":"בריבוע לופה פסיפס 3X4 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 3X4 מסגרת שחורה","product_type":7,"category":1,"format":334,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":432,"unit_price":432,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_343_n_2_2_4_3_n","price_group":5,"title":"בריבוע לופה פסיפס 4X3 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 4X3 מסגרת שחורה","product_type":7,"category":1,"format":343,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":432,"unit_price":432,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_344_n_2_2_4_4_n","price_group":5,"title":"בריבוע לופה פסיפס 4X4 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 4X4 מסגרת שחורה","product_type":7,"category":1,"format":344,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":576,"unit_price":576,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_345_n_2_2_4_5_n","price_group":5,"title":"בריבוע לופה פסיפס 4X5 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 4X5 מסגרת שחורה","product_type":7,"category":1,"format":345,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":720,"unit_price":720,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_346_n_2_2_4_6_n","price_group":5,"title":"בריבוע לופה פסיפס 4X6 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 4X6 מסגרת שחורה","product_type":7,"category":1,"format":346,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":864,"unit_price":864,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_354_n_2_2_5_4_n","price_group":5,"title":"בריבוע לופה פסיפס 5X4 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 5X4 מסגרת שחורה","product_type":7,"category":1,"format":354,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":720,"unit_price":720,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_355_n_2_2_5_5_n","price_group":5,"title":"בריבוע לופה פסיפס 5X5 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 5X5 מסגרת שחורה","product_type":7,"category":1,"format":355,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":900,"unit_price":900,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_356_n_2_2_5_6_n","price_group":5,"title":"בריבוע לופה פסיפס 5X6 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 5X6 מסגרת שחורה","product_type":7,"category":1,"format":356,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1080,"unit_price":1080,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_364_n_2_2_6_4_n","price_group":5,"title":"בריבוע לופה פסיפס 5X4 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 6X4 מסגרת שחורה","product_type":7,"category":1,"format":364,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":864,"unit_price":864,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_365_n_2_2_6_5_n","price_group":5,"title":"בריבוע לופה פסיפס 6X5 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 6X5 מסגרת שחורה","product_type":7,"category":1,"format":365,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1080,"unit_price":1080,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_366_n_2_2_6_6_n","price_group":5,"title":"בריבוע לופה פסיפס 6X6 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 6X6 מסגרת שחורה","product_type":7,"category":1,"format":366,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1296,"unit_price":1296,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_322_n_2_1_2_2_n","price_group":5,"title":"בריבוע לופה פסיפס 2X2 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 2X2 מסגרת לבנה","product_type":7,"category":1,"format":322,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":144,"unit_price":144,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_323_n_2_1_2_3_n","price_group":5,"title":"בריבוע לופה פסיפס 2X3 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 2X3 מסגרת לבנה","product_type":7,"category":1,"format":323,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":216,"unit_price":216,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_332_n_2_1_3_2_n","price_group":5,"title":"בריבוע לופה פסיפס 3X2 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 3X2 מסגרת לבנה","product_type":7,"category":1,"format":332,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":216,"unit_price":216,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_333_n_2_1_3_3_n","price_group":5,"title":"בריבוע לופה פסיפס 3X3 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 3X3 מסגרת לבנה","product_type":7,"category":1,"format":333,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":324,"unit_price":324,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_334_n_2_1_3_4_n","price_group":5,"title":"בריבוע לופה פסיפס 3X4 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 3X4 מסגרת לבנה","product_type":7,"category":1,"format":334,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":432,"unit_price":432,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_343_n_2_1_4_3_n","price_group":5,"title":"בריבוע לופה פסיפס 4X3 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 4X3 מסגרת לבנה","product_type":7,"category":1,"format":343,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":432,"unit_price":432,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_344_n_2_1_4_4_n","price_group":5,"title":"בריבוע לופה פסיפס 4X4 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 4X4 מסגרת לבנה","product_type":7,"category":1,"format":344,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":576,"unit_price":576,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_345_n_2_1_4_5_n","price_group":5,"title":"בריבוע לופה פסיפס 4X5 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 4X5 מסגרת לבנה","product_type":7,"category":1,"format":345,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":720,"unit_price":720,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_346_n_2_1_4_6_n","price_group":5,"title":"בריבוע לופה פסיפס 4X6 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 4X6 מסגרת לבנה","product_type":7,"category":1,"format":346,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":864,"unit_price":864,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_354_n_2_1_5_4_n","price_group":5,"title":"בריבוע לופה פסיפס 5X4 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 5X4 מסגרת לבנה","product_type":7,"category":1,"format":354,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":720,"unit_price":720,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_355_n_2_1_5_5_n","price_group":5,"title":"בריבוע לופה פסיפס 5X5 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 5X5 מסגרת לבנה","product_type":7,"category":1,"format":355,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":900,"unit_price":900,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_356_n_2_1_5_6_n","price_group":5,"title":"בריבוע לופה פסיפס 5X6 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 5X6 מסגרת לבנה","product_type":7,"category":1,"format":356,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1080,"unit_price":1080,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_364_n_2_1_6_4_n","price_group":5,"title":"בריבוע לופה פסיפס 6X4 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 6X4 מסגרת לבנה","product_type":7,"category":1,"format":364,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":864,"unit_price":864,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_365_n_2_1_6_5_n","price_group":5,"title":"בריבוע לופה פסיפס 6X5 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 6X5 מסגרת לבנה","product_type":7,"category":1,"format":365,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1080,"unit_price":1080,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_366_n_2_1_6_6_n","price_group":5,"title":"בריבוע לופה פסיפס 6X6 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 6X6 מסגרת לבנה","product_type":7,"category":1,"format":366,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1296,"unit_price":1296,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None}],"accessories":[{"catalogue_code":"99_a_n_n_n_n_11","price_group":99,"title":"פלס לופה בריבוע","invoice_name":"פלס לופה בריבוע","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"leveler","design":"","makat":"LXXXXX","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"99_a_n_n_n_n_12","price_group":99,"title":"מדבקה לופה בריבוע","invoice_name":"מדבקה לופה בריבוע","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"sticker","design":"","makat":"LXXXXX","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"99_a_n_n_n_n_13","price_group":99,"title":"בריבוע לופה לפסיפס ספייסרים","invoice_name":"בריבוע לופה לפסיפס ספייסרים","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"spacer","design":"","makat":"LR00044","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"99_a_n_n_n_n_14","price_group":99,"title":"בריבוע לופה לפסיפס מתלה","invoice_name":"בריבוע לופה לפסיפס מתלה","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"picture hanger ","design":"","makat":"LR00043","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"99_a_n_n_n_n_15","price_group":99,"title":"אריזת מתנה","invoice_name":"tiles gift Wrap","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"Wrap","design":"","makat":"L_XXXXX","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":10,"unit_price":10,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None}],"deliveries":[{"catalogue_code":"98_n_n_n_n_n_4","price_group":98,"title":"Registered","invoice_name":"משלוח דואר רשום\t","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"4","design":"","makat":"BK-Mr-Dlv-000001","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":26,"unit_price":26,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_5","price_group":98,"title":"SC\\lupa","invoice_name":"משלוח איסוף עצמי לופה","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"5","design":"","makat":"BK-Mr-Dlv-000013","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_23","price_group":98,"title":"BHHome","invoice_name":"משלוח לבית הלקוח","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"23","design":"","makat":"BK-Mr-Dlv-000025","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":39,"unit_price":39,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_12","price_group":98,"title":"NOSHIPPMENT","invoice_name":"איחוד משלוחים","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"12","design":"","makat":"BK-Mr-Dlv-000012","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_18","price_group":98,"title":"Tapuz","invoice_name":"משלוח עד הבית\t","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"18","design":"","makat":"BK-Mr-Dlv-000021","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":39,"unit_price":39,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_19","price_group":98,"title":"Asafta","invoice_name":"משלוח אספתא","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"19","design":"","makat":"BK-Mr-Dlv-000022","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_20","price_group":98,"title":"OrderCon","invoice_name":"משלוח מרוכז","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"20","design":"","makat":"BK-Mr-Dlv-000023","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_21","price_group":98,"title":"BHShops","invoice_name":"משלוח איסוף מנקודות מסירה","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"21","design":"","makat":"BK-Mr-Dlv-000024","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":18,"unit_price":18,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_23","price_group":98,"title":"BHHome","invoice_name":"משלוח לבית הלקוח","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"23","design":"","makat":"BK-Mr-Dlv-000025","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":39,"unit_price":39,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None}],"designs":[]},"delivery_details":{"delivery_type":0,"first_name":None,"last_name":None,"insert_date":"0001-01-01T00:00:00","city":None,"street":None,"building_num":None,"apartment_num":None,"zip":None,"phone_number":None,"remark":None,"shop":{"city":None,"site":None,"site_id":-1},"final_price":0},"invoice":{"details":{"first_name":None,"last_name":None,"city":None,"street":None,"building_num":None,"apartment_num":None,"zip":None,"company":None,"company_id":None,"company_city":None,"company_street":None},"items":None},"coupons":None,"payments":None}

    headers = {
        'authority': 'paymentsv4-api.lupa.co.il',
        'accept': '*/*',
        'accept-language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7',
        'content-type': 'text/plain;charset=UTF-8',
        'origin': 'https://paymentsv4-ui.lupa.co.il',
        'referer': 'https://paymentsv4-ui.lupa.co.il/',
        'sec-ch-ua': '"Not_A Brand";v="8", "Chromium";v="120", "Google Chrome";v="120"',
        'sec-ch-ua-mobile': '?0',

        'sec-ch-ua-platform': '"Windows"',
        'sec-fetch-dest': 'empty',
        'sec-fetch-mode': 'cors',
        'sec-fetch-site': 'same-site',
        'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',
        'Cookie': 'ASP.NET_SessionId=xp2vl01tytfwykjvut525jd2'
    }
    json_data = json.dumps(payload)
    response = requests.request("POST", url, headers=headers, data=json_data)

    print(response.text)

    data = json.loads(response.text)

    if  data["isValid"] != True:
            send_slack(data)


def send_slack(json_data):
    # If the assert condition is not met, send a message to Slack
        slack_webhook_url = "https://hooks.slack.com/services/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"

        error_message = f"The 'check_coupon' in tiles is return False .{json_data['errorMessage']}"

        # You can customize the message format according to your needs
        payload = {
            "text": error_message,
            "username": "Error Bot",
            "channel": "#your-error-channel"
        }

        # Send the message to Slack using requests library
        response = requests.post(slack_webhook_url, json=payload)

        # Check if the request was successful
        if response.status_code != 200:
            print(f"Failed to send message to Slack. Status Code: {response.status_code}")


check_get_coupon_tiles()
