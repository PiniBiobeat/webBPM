import json

import requests

url = "https://paymentsv4-api.lupa.co.il/api.aspx?method=credit_guard_screen&invoice_matrix=false&source_type=tiles&language=&source_device=desktop&token=092115016142065061027123077073170170088160131142208111186130111163076106122149205107087224089224063179033231031009196162052057222115104008220089&show_header=&newsletter=null"
headers = {
  'authority': 'paymentsv4-api.lupa.co.il',
  'accept': '*/*',
  'accept-language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7',
  'content-type': 'text/plain;charset=UTF-8',
  'origin': 'https://paymentsv4-ui.lupa.co.il',
  'referer': 'https://paymentsv4-ui.lupa.co.il/',
  'sec-ch-ua': '"Not A(Brand";v="99", "Google Chrome";v="121", "Chromium";v="121"',
  'sec-ch-ua-mobile': '?0',
  'sec-ch-ua-platform': '"Windows"',
  'sec-fetch-dest': 'empty',
  'sec-fetch-mode': 'cors',
  'sec-fetch-site': 'same-site',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36',
  'Cookie': 'ASP.NET_SessionId=13y2knaexplrukuczt33wnuv'
}


payload ={"master_id":0,"user_email":None,"order_id":14127018,"membership_level":0,"engines":["Tiles"],"partitions":[3],"items":[{"item_id":919844,"item_guid":"00000000-0000-0000-0000-000000000000","project_guid":"00000000-0000-0000-0000-000000000000","url":"https://tiles-api.lupa.co.il/img.aspx?token=092115016142065061027123077073170170088160131142208111186130111163076106122149205107087224089224063179033231031009196162052057222115104008220089&image=B29acd9b42dc04a0290f112665b52964b.jpg&projectguid=278e1d0f5f8c44c1a6ee1a875315559d&type=no","itemImageUrl":"http://paymentsv4-api.lupa.co.il//img/black_frame.svg","parent_item_id":None,"product_type":7,"format":322,"material":2,"cover":None,"theme":None,"pages":None,"feature":None,"catalogue_code":"7_322_n_2_2_2_2_n","title":None,"price_group":0,"is_paspartu":False,"item_filter":"no","is_black_white":False,"frame_color":2,"quantity":1,"item_q1_price":144,"item_qx_price":144,"item_final_price":144,"item_total_price":144,"discounts":{"sale":0,"sale_remark":"","membership":0}}],"accessories":None,"delivery":{"item_id":0,"item_guid":"00000000-0000-0000-0000-000000000000","project_guid":"00000000-0000-0000-0000-000000000000","url":None,"itemImageUrl":None,"parent_item_id":None,"product_type":0,"format":None,"material":None,"cover":None,"theme":None,"pages":None,"feature":None,"catalogue_code":"BK-Mr-Dlv-000022","title":"אספתא: איסוף מראשל\"צ","price_group":0,"is_paspartu":None,"item_filter":None,"is_black_white":None,"frame_color":None,"quantity":0,"item_q1_price":0,"item_qx_price":0,"item_final_price":0,"item_total_price":0,"discounts":None},"price_list":{"products":[{"catalogue_code":"7_0_n_1_n_n_n_n","price_group":1,"title":"20X20 בריבוע לופה","invoice_name":"20X20 בריבוע לופה","product_type":7,"category":1,"format":0,"material":1,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00001","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":42,"unit_price":42,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":36,"unit_price":32,"discounts":{"sale":4,"sale_remark":"מבצע סוף שנה 2023","membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_0_n_2_1_n_n_n","price_group":1,"title":"לבנה מסגרת 20X20 בריבוע לופה","invoice_name":"לבנה מסגרת 20X20 בריבוע לופה","product_type":7,"category":1,"format":0,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00004","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":42,"unit_price":42,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":36,"unit_price":32,"discounts":{"sale":4,"sale_remark":"מבצע סוף שנה 2023","membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_0_n_2_2_n_n_n","price_group":1,"title":"שחורה מסגרת 20X20 בריבוע לופה","invoice_name":"שחורה מסגרת 20X20 בריבוע לופה","product_type":7,"category":1,"format":0,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00010","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":42,"unit_price":42,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":36,"unit_price":32,"discounts":{"sale":4,"sale_remark":"מבצע סוף שנה 2023","membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_364_n_2_2_6_4_n","price_group":5,"title":"בריבוע לופה פסיפס 5X4 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 6X4 מסגרת שחורה","product_type":7,"category":1,"format":364,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":864,"unit_price":864,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_1_n_1_n_n_n_n","price_group":1,"title":"30X30 בריבוע לופה","invoice_name":"30X30 בריבוע לופה","product_type":7,"category":1,"format":1,"material":1,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00002","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":69,"unit_price":69,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":63,"unit_price":59,"discounts":{"sale":4,"sale_remark":"מבצע סוף שנה 2023","membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_1_n_2_1_n_n_n","price_group":1,"title":"לבנה מסגרת 30X30 בריבוע לופה","invoice_name":"לבנה מסגרת 30X30 בריבוע לופה","product_type":7,"category":1,"format":1,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00003","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":69,"unit_price":69,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":63,"unit_price":59,"discounts":{"sale":4,"sale_remark":"מבצע סוף שנה 2023","membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_1_n_2_2_n_n_n","price_group":1,"title":"שחורה מסגרת 30X30 בריבוע לופה","invoice_name":"שחורה מסגרת 30X30 בריבוע לופה","product_type":7,"category":1,"format":1,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00012","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":69,"unit_price":69,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":63,"unit_price":59,"discounts":{"sale":4,"sale_remark":"מבצע סוף שנה 2023","membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_354_n_2_2_5_4_n","price_group":5,"title":"בריבוע לופה פסיפס 5X4 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 5X4 מסגרת שחורה","product_type":7,"category":1,"format":354,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":720,"unit_price":720,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_322_n_2_2_2_2_n","price_group":5,"title":"בריבוע לופה פסיפס 2X2 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 2X2 מסגרת שחורה","product_type":7,"category":1,"format":322,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":144,"unit_price":144,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_332_n_2_2_3_2_n","price_group":5,"title":"בריבוע לופה פסיפס 3X2 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 3X2 מסגרת שחורה","product_type":7,"category":1,"format":332,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":216,"unit_price":216,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_355_n_2_2_5_5_n","price_group":5,"title":"בריבוע לופה פסיפס 5X5 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 5X5 מסגרת שחורה","product_type":7,"category":1,"format":355,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":900,"unit_price":900,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_356_n_2_2_5_6_n","price_group":5,"title":"בריבוע לופה פסיפס 5X6 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 5X6 מסגרת שחורה","product_type":7,"category":1,"format":356,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1080,"unit_price":1080,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_364_n_2_1_6_4_n","price_group":5,"title":"בריבוע לופה פסיפס 6X4 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 6X4 מסגרת לבנה","product_type":7,"category":1,"format":364,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":864,"unit_price":864,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_365_n_2_2_6_5_n","price_group":5,"title":"בריבוע לופה פסיפס 6X5 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 6X5 מסגרת שחורה","product_type":7,"category":1,"format":365,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1080,"unit_price":1080,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_366_n_2_2_6_6_n","price_group":5,"title":"בריבוע לופה פסיפס 6X6 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 6X6 מסגרת שחורה","product_type":7,"category":1,"format":366,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1296,"unit_price":1296,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_346_n_2_2_4_6_n","price_group":5,"title":"בריבוע לופה פסיפס 4X6 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 4X6 מסגרת שחורה","product_type":7,"category":1,"format":346,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":864,"unit_price":864,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_343_n_2_1_4_3_n","price_group":5,"title":"בריבוע לופה פסיפס 4X3 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 4X3 מסגרת לבנה","product_type":7,"category":1,"format":343,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":432,"unit_price":432,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_344_n_2_1_4_4_n","price_group":5,"title":"בריבוע לופה פסיפס 4X4 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 4X4 מסגרת לבנה","product_type":7,"category":1,"format":344,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":576,"unit_price":576,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_346_n_2_1_4_6_n","price_group":5,"title":"בריבוע לופה פסיפס 4X6 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 4X6 מסגרת לבנה","product_type":7,"category":1,"format":346,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":864,"unit_price":864,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_354_n_2_1_5_4_n","price_group":5,"title":"בריבוע לופה פסיפס 5X4 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 5X4 מסגרת לבנה","product_type":7,"category":1,"format":354,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":720,"unit_price":720,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_355_n_2_1_5_5_n","price_group":5,"title":"בריבוע לופה פסיפס 5X5 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 5X5 מסגרת לבנה","product_type":7,"category":1,"format":355,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":900,"unit_price":900,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_356_n_2_1_5_6_n","price_group":5,"title":"בריבוע לופה פסיפס 5X6 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 5X6 מסגרת לבנה","product_type":7,"category":1,"format":356,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1080,"unit_price":1080,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_365_n_2_1_6_5_n","price_group":5,"title":"בריבוע לופה פסיפס 6X5 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 6X5 מסגרת לבנה","product_type":7,"category":1,"format":365,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1080,"unit_price":1080,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_323_n_2_2_2_3_n","price_group":5,"title":"בריבוע לופה פסיפס 2X3 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 2X3 מסגרת שחורה","product_type":7,"category":1,"format":323,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":216,"unit_price":216,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_322_n_2_1_2_2_n","price_group":5,"title":"בריבוע לופה פסיפס 2X2 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 2X2 מסגרת לבנה","product_type":7,"category":1,"format":322,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":144,"unit_price":144,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_323_n_2_1_2_3_n","price_group":5,"title":"בריבוע לופה פסיפס 2X3 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 2X3 מסגרת לבנה","product_type":7,"category":1,"format":323,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":216,"unit_price":216,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_345_n_2_1_4_5_n","price_group":5,"title":"בריבוע לופה פסיפס 4X5 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 4X5 מסגרת לבנה","product_type":7,"category":1,"format":345,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":720,"unit_price":720,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_333_n_2_2_3_3_n","price_group":5,"title":"בריבוע לופה פסיפס 3X3 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 3X3 מסגרת שחורה","product_type":7,"category":1,"format":333,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":324,"unit_price":324,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_334_n_2_2_3_4_n","price_group":5,"title":"בריבוע לופה פסיפס 3X4 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 3X4 מסגרת שחורה","product_type":7,"category":1,"format":334,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":432,"unit_price":432,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_333_n_2_1_3_3_n","price_group":5,"title":"בריבוע לופה פסיפס 3X3 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 3X3 מסגרת לבנה","product_type":7,"category":1,"format":333,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":324,"unit_price":324,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_334_n_2_1_3_4_n","price_group":5,"title":"בריבוע לופה פסיפס 3X4 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 3X4 מסגרת לבנה","product_type":7,"category":1,"format":334,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":432,"unit_price":432,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_332_n_2_1_3_2_n","price_group":5,"title":"בריבוע לופה פסיפס 3X2 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 3X2 מסגרת לבנה","product_type":7,"category":1,"format":332,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":216,"unit_price":216,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_343_n_2_2_4_3_n","price_group":5,"title":"בריבוע לופה פסיפס 4X3 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 4X3 מסגרת שחורה","product_type":7,"category":1,"format":343,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":432,"unit_price":432,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_344_n_2_2_4_4_n","price_group":5,"title":"בריבוע לופה פסיפס 4X4 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 4X4 מסגרת שחורה","product_type":7,"category":1,"format":344,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":576,"unit_price":576,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_345_n_2_2_4_5_n","price_group":5,"title":"בריבוע לופה פסיפס 4X5 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 4X5 מסגרת שחורה","product_type":7,"category":1,"format":345,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":720,"unit_price":720,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_366_n_2_1_6_6_n","price_group":5,"title":"בריבוע לופה פסיפס 6X6 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 6X6 מסגרת לבנה","product_type":7,"category":1,"format":366,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1296,"unit_price":1296,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None}],"accessories":[{"catalogue_code":"99_a_n_n_n_n_11","price_group":99,"title":"פלס לופה בריבוע","invoice_name":"פלס לופה בריבוע","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"leveler","design":"","makat":"LXXXXX","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"99_a_n_n_n_n_12","price_group":99,"title":"מדבקה לופה בריבוע","invoice_name":"מדבקה לופה בריבוע","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"sticker","design":"","makat":"LXXXXX","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"99_a_n_n_n_n_15","price_group":99,"title":"אריזת מתנה","invoice_name":"tiles gift Wrap","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"Wrap","design":"","makat":"L_XXXXX","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":10,"unit_price":10,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"99_a_n_n_n_n_14","price_group":99,"title":"בריבוע לופה לפסיפס מתלה","invoice_name":"בריבוע לופה לפסיפס מתלה","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"picture hanger ","design":"","makat":"LR00043","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"99_a_n_n_n_n_13","price_group":99,"title":"בריבוע לופה לפסיפס ספייסרים","invoice_name":"בריבוע לופה לפסיפס ספייסרים","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"spacer","design":"","makat":"LR00044","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None}],"deliveries":[{"catalogue_code":"98_n_n_n_n_n_23","price_group":98,"title":"BHHome","invoice_name":"משלוח לבית הלקוח","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"23","design":"","makat":"BK-Mr-Dlv-000025","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":39,"unit_price":39,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_23","price_group":98,"title":"BHHome","invoice_name":"משלוח לבית הלקוח","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"23","design":"","makat":"BK-Mr-Dlv-000025","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":39,"unit_price":39,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_21","price_group":98,"title":"BHShops","invoice_name":"משלוח איסוף מנקודות מסירה","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"21","design":"","makat":"BK-Mr-Dlv-000024","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":18,"unit_price":18,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_20","price_group":98,"title":"OrderCon","invoice_name":"משלוח מרוכז","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"20","design":"","makat":"BK-Mr-Dlv-000023","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_19","price_group":98,"title":"Asafta","invoice_name":"משלוח אספתא","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"19","design":"","makat":"BK-Mr-Dlv-000022","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_18","price_group":98,"title":"Tapuz","invoice_name":"משלוח עד הבית\t","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"18","design":"","makat":"BK-Mr-Dlv-000021","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":39,"unit_price":39,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_12","price_group":98,"title":"NOSHIPPMENT","invoice_name":"איחוד משלוחים","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"12","design":"","makat":"BK-Mr-Dlv-000012","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_5","price_group":98,"title":"SC\\lupa","invoice_name":"משלוח איסוף עצמי לופה","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"5","design":"","makat":"BK-Mr-Dlv-000013","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_4","price_group":98,"title":"Registered","invoice_name":"משלוח דואר רשום\t","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"4","design":"","makat":"BK-Mr-Dlv-000001","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":26,"unit_price":26,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None}],"designs":[]},"delivery_details":{"delivery_type":19,"first_name":"בדיקה","last_name":"פיני","insert_date":"0001-01-01T00:00:00","city":"א.תעשיה מישור אדומים","street":"ללא רחוב","building_num":"333","apartment_num":"","zip":"","phone_number":"0517608055","remark":None,"shop":None,"final_price":0},"invoice":{"details":{"first_name":"בדיקה","last_name":"פיני","city":"א.תעשיה מישור אדומים","street":"ללא רחוב","building_num":"333","apartment_num":None,"zip":None,"company":None,"company_id":None,"company_city":None,"company_street":None,"phone_number":"0517608055"},"items":[{"item_id":919844,"catalog_number":"LP00001","quantity":1,"remark":"","description":"בריבוע לופה פסיפס 2X2 מסגרת שחורה","skin":"","base_price":144,"unit_price":144,"total_price":144},{"item_id":14127018,"catalog_number":"BK-Mr-Dlv-000022","quantity":1,"remark":"","description":"משלוח אספתא","skin":"","base_price":0,"unit_price":0,"total_price":0}]},"coupons":{"coupons":[],"bundles":[],"combinations":[{"cry_hash":"128064164169102003119019231035193131035179126244120158077250146249246014004049050119194226074158090083009140220135058121094255104137011255033163247073133246239047028059063161073072202144156013100173124002090028038115079078230056084183041185026130222205018092145091007200043132195179012069195010013170039023023030033018105171051014192053048064140193231061071085025125223092031237148016176107222067230135115152132173221162124041151003076137245050063158081168102026089150119057053254083135065099002107226121239002099082193054065176058150220067059246144240061185245164184202157111081217134028186140155091114236056251154164252070128204245255134023048228238056086176145203173221115073138110086223214194011134180162247238052044040022031077058192100039133054122154080017148104231238050204180227050047162138156208171050157004249021189062167205102023226125189153048125199085069243076062174227043058247072059226112100125003188211061210079054179075012213193109094182155060102187147232117103127241002143054045228048079161","order_id":14127018,"is_selected":True,"coupon_ids":[],"total_items_base_price":144,"total_items_final_price":144,"delivery_base_price":0,"delivery_final_price":0,"total_final_price":144,"excess_discount":0}],"messages":[],"user_selection":0},"payments":{"payments":[],"total_payment":0,"amount_due":144,"is_deferred":False,"cry_hash":"083166126198053116176159161116098217026059037031160104021063032084243010237113232137237087222178228188245132160253182240090222216117067220121077206097092030213192082226009164113232079020030215072112090031121105127061040130075196201057240170219033161201067194104037089061218159063052172046060169000129158195052173027004052160143101128054249065008059164195028243141021213091050067080057180031251156063238087037061123026081112172151052"}}
json_data = json.dumps(payload)


def test_credit_guard_screen_tiles():
    data_error = None
    try:
        response = requests.request("POST", url, headers=headers, data=json_data)

        data = json.loads(response.text)
        data_error = data["errorMessage"]
        if response.status_code == 200 and data['isValid'] == True:
            print(f"The POST request to URL '{url}' is valid and returns a successful response.")
        else:
            print(
                f"The POST request to URL '{url}' is valid but returns a non-successful response with status code {response.status_code}.")
            send_to_slack(data_error)
    except requests.exceptions.RequestException as e:
        print(f"The POST request to URL '{url}' is not valid or cannot be reached. Error: {e}")
        send_to_slack(data_error)


def send_to_slack(data_error):
    # Replace 'YOUR_WEBHOOK_URL' with your actual webhook URL
    webhook_url = 'https://hooks.slack.com/services/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'

    # Create a dictionary containing the message payload
    message_payload = {
        'text': f'The POST request to URL credit guard screen tiles is valid but returns a non-successful response with status code error {data_error} !',
        'username': 'system-monitor',  # Optional: Customize the username
        'icon_emoji': ':robot_face:'  # Optional: Customize the icon
    }

    # Convert the payload to JSON format
    payload_json = json.dumps(message_payload)

    # Send the POST request to the Slack webhook URL
    response = requests.post(webhook_url, data=payload_json, headers={'Content-Type': 'application/json'})

    if response.status_code == 200:
        print("Message sent successfully")
    else:
        print(f"Error sending message: {response.text}")