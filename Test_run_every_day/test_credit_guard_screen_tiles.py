import json

import requests

url = "https://paymentsv4-api.lupa.co.il/api.aspx?method=credit_guard_screen&invoice_matrix=False&source_type=tiles&language=&source_device=desktop&token=tIKxzLq2DpXhfKaojAiq64JPBL7rMbrlZCVq9nzONBd2V4pkHlsc1T7a_DKxxMRk_FtOVH0Br8tM4htwMzEqmE4uD52yYfzGVoC-WrFkEVkrSLsi7XkRTf2KuMh1YjP9BhY22BFeqEHhBbFiMAmL-XwX_SmfvR02dzdD732LdYcwr0yWbnN6pTnYcVb2vAxXpO30SbjgulGG5Is2YqgyQOWqP_bupDMKJX708AyhIGqimdMM3BHgg4zKlqECP-x3qJwuqqYILU2fCk3sPCWXhTHs_lQkrIvGbKcNw1i8g4BvlHX4K87sHUzAErdsY3xqix_9qZcPbIEL3QbXC8A96Q2&show_header=&newsletter=None"
headers = {
  'authority': 'paymentsv4-api.lupa.co.il',
  'accept': '*/*',
  'accept-language': 'he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7',
  'content-type': 'text/plain;charset=UTF-8',
  'origin': 'https://paymentsv4-ui.lupa.co.il',
  'referer': 'https://paymentsv4-ui.lupa.co.il/',
  'sec-ch-ua': '"Not A(Brand";v="99", "Google Chrome";v="121", "Chromium";v="121"',
  'sec-ch-ua-mobile': '?0',
  'sec-ch-ua-platform': '"Windows"',
  'sec-fetch-dest': 'empty',
  'sec-fetch-mode': 'cors',
  'sec-fetch-site': 'same-site',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36',
  'Cookie': 'ASP.NET_SessionId=13y2knaexplrukuczt33wnuv'
}


payload = {"master_id":0,"user_email":None,"order_id":14129252,"membership_level":0,"engines":["Tiles"],"partitions":[3],"items":[{"item_id":938190,"item_guid":"00000000-0000-0000-0000-000000000000","project_guid":"00000000-0000-0000-0000-000000000000","url":"https://tiles-api-test.lupa.co.il/img.aspx?token=tIKxzLq2DpXhfKaojAiq64JPBL7rMbrlZCVq9nzONBd2V4pkHlsc1T7a_DKxxMRk_FtOVH0Br8tM4htwMzEqmE4uD52yYfzGVoC-WrFkEVkrSLsi7XkRTf2KuMh1YjP9BhY22BFeqEHhBbFiMAmL-XwX_SmfvR02dzdD732LdYcwr0yWbnN6pTnYcVb2vAxXpO30SbjgulGG5Is2YqgyQOWqP_bupDMKJX708AyhIGqimdMM3BHgg4zKlqECP-x3qJwuqqYILU2fCk3sPCWXhTHs_lQkrIvGbKcNw1i8g4BvlHX4K87sHUzAErdsY3xqix_9qZcPbIEL3QbXC8A96Q2&image=B44c1094f7e644a6b8ac414ed3e08dffd.jpg&projectguid=52722f90274949beb61e95c28aedff0f&type=no","itemImageUrl":"http://paymentsv4-api.lupa.co.il//img/black_frame.svg","parent_item_id":None,"product_type":7,"format":0,"material":2,"cover":None,"theme":None,"pages":None,"feature":None,"catalogue_code":"7_0_n_2_2_n_n_n","title":None,"price_group":0,"is_paspartu":False,"item_filter":"no","is_black_white":False,"frame_color":2,"quantity":1,"item_q1_price":42,"item_qx_price":42,"item_final_price":42,"item_total_price":42,"discounts":{"sale":0,"sale_remark":"","membership":0}}],"accessories":None,"delivery":{"item_id":0,"item_guid":"00000000-0000-0000-0000-000000000000","project_guid":"00000000-0000-0000-0000-000000000000","url":None,"itemImageUrl":None,"parent_item_id":None,"product_type":98,"format":None,"material":None,"cover":None,"theme":None,"pages":None,"feature":None,"catalogue_code":"BK-Mr-Dlv-000023","title":"מרוכזז","price_group":0,"is_paspartu":None,"item_filter":None,"is_black_white":None,"frame_color":None,"quantity":0,"item_q1_price":0,"item_qx_price":0,"item_final_price":0,"item_total_price":0,"discounts":None},"price_list":{"products":[{"catalogue_code":"7_0_n_1_n_n_n_n","price_group":1,"title":"20X20 בריבוע לופה","invoice_name":"20X20 בריבוע לופה","product_type":7,"category":1,"format":0,"material":1,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00001","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":42,"unit_price":42,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":36,"unit_price":36,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_0_n_2_1_n_n_n","price_group":1,"title":"לבנה מסגרת 20X20 בריבוע לופה","invoice_name":"לבנה מסגרת 20X20 בריבוע לופה","product_type":7,"category":1,"format":0,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00004","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":42,"unit_price":42,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":36,"unit_price":36,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_0_n_2_2_n_n_n","price_group":1,"title":"שחורה מסגרת 20X20 בריבוע לופה","invoice_name":"שחורה מסגרת 20X20 בריבוע לופה","product_type":7,"category":1,"format":0,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00010","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":42,"unit_price":42,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":36,"unit_price":36,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_364_n_2_2_6_4_n","price_group":5,"title":"בריבוע לופה פסיפס 5X4 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 6X4 מסגרת שחורה","product_type":7,"category":1,"format":364,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":864,"unit_price":864,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_1_n_1_n_n_n_n","price_group":1,"title":"30X30 בריבוע לופה","invoice_name":"30X30 בריבוע לופה","product_type":7,"category":1,"format":1,"material":1,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00002","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":69,"unit_price":69,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":63,"unit_price":63,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_1_n_2_1_n_n_n","price_group":1,"title":"לבנה מסגרת 30X30 בריבוע לופה","invoice_name":"לבנה מסגרת 30X30 בריבוע לופה","product_type":7,"category":1,"format":1,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00003","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":69,"unit_price":69,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":63,"unit_price":63,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_1_n_2_2_n_n_n","price_group":1,"title":"שחורה מסגרת 30X30 בריבוע לופה","invoice_name":"שחורה מסגרת 30X30 בריבוע לופה","product_type":7,"category":1,"format":1,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LR00012","remark":None,"price_ranges":[{"price_group_step":1,"from_quantity":1,"to_quantity":9,"base_price":69,"unit_price":69,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""},{"price_group_step":2,"from_quantity":10,"to_quantity":9999,"base_price":63,"unit_price":63,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_354_n_2_2_5_4_n","price_group":5,"title":"בריבוע לופה פסיפס 5X4 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 5X4 מסגרת שחורה","product_type":7,"category":1,"format":354,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":720,"unit_price":720,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_322_n_2_2_2_2_n","price_group":5,"title":"בריבוע לופה פסיפס 2X2 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 2X2 מסגרת שחורה","product_type":7,"category":1,"format":322,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":144,"unit_price":144,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_332_n_2_2_3_2_n","price_group":5,"title":"בריבוע לופה פסיפס 3X2 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 3X2 מסגרת שחורה","product_type":7,"category":1,"format":332,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":216,"unit_price":216,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_355_n_2_2_5_5_n","price_group":5,"title":"בריבוע לופה פסיפס 5X5 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 5X5 מסגרת שחורה","product_type":7,"category":1,"format":355,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":900,"unit_price":900,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_356_n_2_2_5_6_n","price_group":5,"title":"בריבוע לופה פסיפס 5X6 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 5X6 מסגרת שחורה","product_type":7,"category":1,"format":356,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1080,"unit_price":1080,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_364_n_2_1_6_4_n","price_group":5,"title":"בריבוע לופה פסיפס 6X4 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 6X4 מסגרת לבנה","product_type":7,"category":1,"format":364,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":864,"unit_price":864,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_365_n_2_2_6_5_n","price_group":5,"title":"בריבוע לופה פסיפס 6X5 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 6X5 מסגרת שחורה","product_type":7,"category":1,"format":365,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1080,"unit_price":1080,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_366_n_2_2_6_6_n","price_group":5,"title":"בריבוע לופה פסיפס 6X6 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 6X6 מסגרת שחורה","product_type":7,"category":1,"format":366,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1296,"unit_price":1296,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_346_n_2_2_4_6_n","price_group":5,"title":"בריבוע לופה פסיפס 4X6 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 4X6 מסגרת שחורה","product_type":7,"category":1,"format":346,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":864,"unit_price":864,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_343_n_2_1_4_3_n","price_group":5,"title":"בריבוע לופה פסיפס 4X3 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 4X3 מסגרת לבנה","product_type":7,"category":1,"format":343,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":432,"unit_price":432,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_344_n_2_1_4_4_n","price_group":5,"title":"בריבוע לופה פסיפס 4X4 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 4X4 מסגרת לבנה","product_type":7,"category":1,"format":344,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":576,"unit_price":576,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_346_n_2_1_4_6_n","price_group":5,"title":"בריבוע לופה פסיפס 4X6 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 4X6 מסגרת לבנה","product_type":7,"category":1,"format":346,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":864,"unit_price":864,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_354_n_2_1_5_4_n","price_group":5,"title":"בריבוע לופה פסיפס 5X4 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 5X4 מסגרת לבנה","product_type":7,"category":1,"format":354,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":720,"unit_price":720,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_355_n_2_1_5_5_n","price_group":5,"title":"בריבוע לופה פסיפס 5X5 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 5X5 מסגרת לבנה","product_type":7,"category":1,"format":355,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":900,"unit_price":900,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_356_n_2_1_5_6_n","price_group":5,"title":"בריבוע לופה פסיפס 5X6 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 5X6 מסגרת לבנה","product_type":7,"category":1,"format":356,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1080,"unit_price":1080,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_365_n_2_1_6_5_n","price_group":5,"title":"בריבוע לופה פסיפס 6X5 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 6X5 מסגרת לבנה","product_type":7,"category":1,"format":365,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1080,"unit_price":1080,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_323_n_2_2_2_3_n","price_group":5,"title":"בריבוע לופה פסיפס 2X3 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 2X3 מסגרת שחורה","product_type":7,"category":1,"format":323,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":216,"unit_price":216,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_322_n_2_1_2_2_n","price_group":5,"title":"בריבוע לופה פסיפס 2X2 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 2X2 מסגרת לבנה","product_type":7,"category":1,"format":322,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":144,"unit_price":144,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_323_n_2_1_2_3_n","price_group":5,"title":"בריבוע לופה פסיפס 2X3 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 2X3 מסגרת לבנה","product_type":7,"category":1,"format":323,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":216,"unit_price":216,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_345_n_2_1_4_5_n","price_group":5,"title":"בריבוע לופה פסיפס 4X5 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 4X5 מסגרת לבנה","product_type":7,"category":1,"format":345,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":720,"unit_price":720,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_333_n_2_2_3_3_n","price_group":5,"title":"בריבוע לופה פסיפס 3X3 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 3X3 מסגרת שחורה","product_type":7,"category":1,"format":333,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":324,"unit_price":324,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_334_n_2_2_3_4_n","price_group":5,"title":"בריבוע לופה פסיפס 3X4 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 3X4 מסגרת שחורה","product_type":7,"category":1,"format":334,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":432,"unit_price":432,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_333_n_2_1_3_3_n","price_group":5,"title":"בריבוע לופה פסיפס 3X3 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 3X3 מסגרת לבנה","product_type":7,"category":1,"format":333,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":324,"unit_price":324,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_334_n_2_1_3_4_n","price_group":5,"title":"בריבוע לופה פסיפס 3X4 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 3X4 מסגרת לבנה","product_type":7,"category":1,"format":334,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":432,"unit_price":432,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_332_n_2_1_3_2_n","price_group":5,"title":"בריבוע לופה פסיפס 3X2 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 3X2 מסגרת לבנה","product_type":7,"category":1,"format":332,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":216,"unit_price":216,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_343_n_2_2_4_3_n","price_group":5,"title":"בריבוע לופה פסיפס 4X3 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 4X3 מסגרת שחורה","product_type":7,"category":1,"format":343,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":432,"unit_price":432,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_344_n_2_2_4_4_n","price_group":5,"title":"בריבוע לופה פסיפס 4X4 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 4X4 מסגרת שחורה","product_type":7,"category":1,"format":344,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":576,"unit_price":576,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_345_n_2_2_4_5_n","price_group":5,"title":"בריבוע לופה פסיפס 4X5 מסגרת שחורה","invoice_name":"בריבוע לופה פסיפס 4X5 מסגרת שחורה","product_type":7,"category":1,"format":345,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":720,"unit_price":720,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"7_366_n_2_1_6_6_n","price_group":5,"title":"בריבוע לופה פסיפס 6X6 מסגרת לבנה","invoice_name":"בריבוע לופה פסיפס 6X6 מסגרת לבנה","product_type":7,"category":1,"format":366,"material":2,"cover":0,"theme":0,"feature":"","design":"","makat":"LP00001","remark":None,"price_ranges":[{"price_group_step":5,"from_quantity":1,"to_quantity":9999,"base_price":1296,"unit_price":1296,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None}],"accessories":[{"catalogue_code":"99_a_n_n_n_n_11","price_group":99,"title":"פלס לופה בריבוע","invoice_name":"פלס לופה בריבוע","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"leveler","design":"","makat":"LXXXXX","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"99_a_n_n_n_n_12","price_group":99,"title":"מדבקה לופה בריבוע","invoice_name":"מדבקה לופה בריבוע","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"sticker","design":"","makat":"LXXXXX","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"99_a_n_n_n_n_15","price_group":99,"title":"אריזת מתנה","invoice_name":"tiles gift Wrap","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"Wrap","design":"","makat":"L_XXXXX","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":10,"unit_price":10,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"99_a_n_n_n_n_14","price_group":99,"title":"בריבוע לופה לפסיפס מתלה","invoice_name":"בריבוע לופה לפסיפס מתלה","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"picture hanger ","design":"","makat":"LR00043","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"99_a_n_n_n_n_13","price_group":99,"title":"בריבוע לופה לפסיפס ספייסרים","invoice_name":"בריבוע לופה לפסיפס ספייסרים","product_type":99,"category":2,"format":-1,"material":0,"cover":0,"theme":0,"feature":"spacer","design":"","makat":"LR00044","remark":None,"price_ranges":[{"price_group_step":99,"from_quantity":1,"to_quantity":9999,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None}],"deliveries":[{"catalogue_code":"98_n_n_n_n_n_23","price_group":98,"title":"BHHome","invoice_name":"משלוח לבית הלקוח","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"23","design":"","makat":"BK-Mr-Dlv-000025","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":39,"unit_price":39,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_23","price_group":98,"title":"BHHome","invoice_name":"משלוח לבית הלקוח","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"23","design":"","makat":"BK-Mr-Dlv-000025","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":39,"unit_price":39,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_21","price_group":98,"title":"BHShops","invoice_name":"משלוח איסוף מנקודות מסירה","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"21","design":"","makat":"BK-Mr-Dlv-000024","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":18,"unit_price":18,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_20","price_group":98,"title":"OrderCon","invoice_name":"משלוח מרוכז","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"20","design":"","makat":"BK-Mr-Dlv-000023","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_19","price_group":98,"title":"Asafta","invoice_name":"משלוח אספתא","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"19","design":"","makat":"BK-Mr-Dlv-000022","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_18","price_group":98,"title":"Tapuz","invoice_name":"משלוח עד הבית\t","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"18","design":"","makat":"BK-Mr-Dlv-000021","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":39,"unit_price":39,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_12","price_group":98,"title":"NOSHIPPMENT","invoice_name":"איחוד משלוחים","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"12","design":"","makat":"BK-Mr-Dlv-000012","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_5","price_group":98,"title":"SC\\lupa","invoice_name":"משלוח איסוף עצמי לופה","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"5","design":"","makat":"BK-Mr-Dlv-000013","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":0,"unit_price":0,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None},{"catalogue_code":"98_n_n_n_n_n_4","price_group":98,"title":"Registered","invoice_name":"משלוח דואר רשום\t","product_type":98,"category":3,"format":-1,"material":0,"cover":0,"theme":0,"feature":"4","design":"","makat":"BK-Mr-Dlv-000001","remark":None,"price_ranges":[{"price_group_step":98,"from_quantity":1,"to_quantity":1,"base_price":26,"unit_price":26,"discounts":{"sale":0,"sale_remark":None,"membership":0},"remark":""}],"relevant_accessories":None}],"designs":[]},"delivery_details":{"delivery_type":18,"first_name":"פיני","last_name":"מארי","insert_date":"0001-01-01T00:00:00","city":"א.ת. שורק-איקאה","street":"היוזמה","building_num":"22","apartment_num":"","zip":"","phone_number":"0537608055","remark":None,"shop":None,"final_price":0},"invoice":{"details":{"first_name":"פיני","last_name":"מארי","city":"א.ת. שורק-איקאה","street":"היוזמה","building_num":"22","apartment_num":None,"zip":None,"company":None,"company_id":None,"company_city":None,"company_street":None,"phone_number":"0537608055"},"items":[{"item_id":938190,"catalog_number":"LR00010","quantity":1,"remark":"","description":"שחורה מסגרת 20X20 בריבוע לופה","skin":"","base_price":42,"unit_price":42,"total_price":42},{"item_id":14129252,"catalog_number":"LR00008","quantity":-1,"remark":"","description":"הנחת קופון לופה בריבוע","skin":None,"base_price":10,"unit_price":10,"total_price":-10},{"item_id":14129252,"catalog_number":"BK-Mr-Dlv-000023","quantity":1,"remark":"","description":"משלוח מרוכז","skin":"","base_price":0,"unit_price":0,"total_price":0}]},"coupons":{"coupons":[{"coupon_id":33716,"coupon_code":"T8233ZBA","coupon_name":"testisof3","coupon_class":"Discount","title":"testisof3","description":"testisof3","message":"בחירה ידנית","expiration":"2025-01-02T23:59:59","discount_type":2,"discount_value":10,"stand_alone_value":10,"display_method":2,"is_removable":True,"terms_and_conditions":"testisof3","coupon_master_id":29852,"collection_bucket_name":"מרוכזf","collection_bucket_message":"מרוכזז","filter":{},"level":1,"is_sale":False,"bundled_coupons":None}],"bundles":[],"combinations":[{"cry_hash":"128064164169102003119019231035193131035179126244120158077250146249246014004049050119194226074158138121192047086042059124072054051218127245174192111195075173222066206212211027149047018250031070136124102246183119152208201172117081043134046224117040175109140200194007111142127202074048246071139122125162039207145136020062050236053057239057168249237050211037184010095025228108101045087251194136060154013028110145122175127132067039249077028020241135092178145183194047081006023028043151198120173118182033056032023232112191242041072043236037104231187186007185024039208040139087100064001040108182052015111040114255123128161126218191105143208114000026042144063178029219044169020105149225080254202227201112149065013170130225107221185146184133016011017162225122118251098139057213057183239052010249165137002112125008059039042014102140210137054149100114150170041013238025125205238185144040247223236148178143026236171175017082200209003070009097227040052146001048031110065227078236104066210064126020239010036097010180030132","order_id":14129252,"is_selected":False,"coupon_ids":[],"total_items_base_price":42,"total_items_final_price":42,"delivery_base_price":0,"delivery_final_price":0,"total_final_price":42,"excess_discount":0},{"cry_hash":"128064164169102003119019231035193131035179126244120158077250146249246014004049050119194226074158138121192047086042059124072054051218127245174192111195075173222066206212211027149047018250031070097020000049043227235047248107217088031236190072135070205233045043151170241123239151016001043059044195204164057101020123231100178229149058094114003094102229161083185046022115169054011225006122186202147071181115196195014056241140186091174096107248181194004128152082009097133074049063046059065109046086248014219063154146211002133189184232155168108126009136062204250072071038017234102240251087184117180044061233001050131146027016112121206247017093093006142127078097021036225157062165143147001022080143241050091248215166112228153233242152083114217186160143210096222067140172013086174245060097063013125017027246129230158058037120048207066135070106144072192215153178180035117049061129086032055219232205100137129167253248238193208006215244214066245129229056096033016035161002231158037204041248208046249044143237213083198024","order_id":14129252,"is_selected":True,"coupon_ids":[33716],"total_items_base_price":42,"total_items_final_price":32,"delivery_base_price":0,"delivery_final_price":0,"total_final_price":32,"excess_discount":0}],"messages":[{"coupon_id":33716,"coupon_code":"T8233ZBA","coupon_name":"testisof3","coupon_title":"testisof3","message_type":10,"title":"דבש!","message":"עם הקוד הזה ההזמנה שלך תגיע עם שאר ההזמנות מהארגון שלך. המשלוח שבחרת בשלב הקודם לא רלוונטי.","terms_and_conditions":"testisof3","is_sale":False}],"user_selection":0},"payments":{"payments":[],"total_payment":0,"amount_due":32,"is_deferred":False,"cry_hash":"083166126198053116176159161116098217026059037031160104021063032084243010237113232137237087222178228188245132160253182240090222216117067220121077206097092030213192082226009164113232079020030215190093188152165215157103194245002177170028084040094225123145215233121246114190150161185251144180003094222073078176055112191046117013096063084228130026190075025006112018229080107026235134165127"}}

json_data = json.dumps(payload)


def test_credit_guard_screen_tiles():
    data_error = None
    try:
        response = requests.request("POST", url, headers=headers, data=json_data)

        data = json.loads(response.text)
        data_error = data.get("errorMessage", "No error message provided")

        if response.status_code == 200 and data.get('isValid') == True:
            print(f"The POST request to URL '{url}' is valid and returns a successful response.")
        elif response.status_code == 500:
            print(f"The POST request to URL '{url}' returned an Internal Server Error (500).")
            send_to_slack(data_error)
        else:
            print(
                f"The POST request to URL '{url}' is valid but returns a non-successful response with status code {response.status_code}.")
            send_to_slack(data_error)
    except requests.exceptions.RequestException as e:
        print(f"The POST request to URL '{url}' is not valid or cannot be reached. Error: {e}")
        send_to_slack(data_error)


def send_to_slack(data_error):
    # Replace 'YOUR_WEBHOOK_URL' with your actual webhook URL
    webhook_url = 'https://hooks.slack.com/services/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'

    # Create a dictionary containing the message payload
    message_payload = {
        'text': f'The POST request to URL credit guard screen tiles is valid but returns a non-successful response with status code error {data_error} !',
        'username': 'system-monitor',  # Optional: Customize the username
        'icon_emoji': ':robot_face:'  # Optional: Customize the icon
    }

    # Convert the payload to JSON format
    payload_json = json.dumps(message_payload)

    # Send the POST request to the Slack webhook URL
    response = requests.post(webhook_url, data=payload_json, headers={'Content-Type': 'application/json'})

    if response.status_code == 200:
        print("Message sent successfully")
    else:
        print(f"Error sending message: {response.text}")